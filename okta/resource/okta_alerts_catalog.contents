alert_name,description,source,source_url,source_repo_url,eventType_regex,stem_regex,method_regex,requestUri_regex,displayMessage_regex,outcomeResult_regex,outcomeReason_regex,debugBehavior_regex,debugLogOnlySecData_regex,dtHash_regex,actorId_regex,actorAltId_regex,actorType_regex,actorName_regex,authExSeshId_regex,threatSuspect_regex,clientDevice_regex,require_is_mod,require_is_proxy,min_risk,enabled,notes
Administrator Privileges Assigned to an Okta Group,Detects when an administrator role is assigned to an Okta group. An adversary may attempt to assign administrator privileges to an Okta group in order to assign additional permissions to compromised user accounts and maintain access to their target organization.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_administrator_privileges_assigned_to_okta_group/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/persistence_administrator_privileges_assigned_to_okta_group.toml,^group\.privilege\.grant$,(?i)group\.grant\.privilege,(?i)grant,,,,,,,,,,,,,,,1,0,40,1,
Administrator Role Assigned to an Okta User,Identifies when an administrator role is assigned to an Okta user. An adversary may attempt to assign an administrator role to an Okta user in order to assign additional permissions to a user account and maintain access to their target's environment.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_administrator_role_assigned_to_okta_user/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/persistence_administrator_role_assigned_to_okta_user.toml,^user\.account\.privilege\.grant$,(?i)user\.account\.privilege,(?i)grant,,,,,,,,,,,,,,,1,0,40,1,
Attempt to Create Okta API Token,Detects attempts to create an Okta API token. An adversary may create an Okta API token to maintain access to an organization's network while they work to achieve their objectives. An attacker may abuse an API token to execute techniques such as creating user accounts or disabling security rules or policies.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_attempt_to_create_okta_api_token/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/persistence_attempt_to_create_okta_api_token.toml,^system\.api_token\.create$,(?i)system\.api\_token,(?i)create,,,,,,,,,,,,,,,1,0,55,1,
Attempt to Deactivate an Okta Application,"Detects attempts to deactivate an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/impact_okta_attempt_to_deactivate_okta_application/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/impact_okta_attempt_to_deactivate_okta_application.toml,^application\.lifecycle\.deactivate$,(?i)application\.lifecycle,(?i)deactivate,,,,,,,,,,,,,,,1,0,60,1,Application deactivation attempts; event.action application.lifecycle.deactivate
Attempt to Deactivate an Okta Network Zone,"Detects attempts to deactivate an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_attempt_to_deactivate_okta_network_zone/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_attempt_to_deactivate_okta_network_zone.toml,^zone\.deactivate$,(?i)zone,(?i)deactivate,,,,,,,,,,,,,,,1,0,60,1,
Attempt to Deactivate an Okta Policy,"Detects attempts to deactivate an Okta policy. An adversary may attempt to deactivate an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to deactivate an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy.toml,^policy\.lifecycle\.deactivate$,(?i)policy\.lifecycle,(?i)deactivate,,,,,,,,,,,,,,,1,0,55,1,
Attempt to Deactivate an Okta Policy Rule,Detects attempts to deactivate a rule within an Okta policy. An adversary may attempt to deactivate a rule within an Okta policy in order to remove or weaken an organization's security controls.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy_rule/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy_rule.toml,^policy\.rule\.deactivate$,(?i)policy\.rule,(?i)deactivate,,,,,,,,,,,,,,,1,0,50,1,
Attempt to Delete an Okta Application,"Detects attempts to delete an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/impact_okta_attempt_to_delete_okta_application/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/impact_okta_attempt_to_delete_okta_application.toml,^application\.lifecycle\.delete$,(?i)application\.lifecycle,(?i)delete,,,,,,,,,,,,,,,1,0,55,1,Application deletion attempts; event.action application.lifecycle.delete
Attempt to Delete an Okta Network Zone,"Detects attempts to delete an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_attempt_to_delete_okta_network_zone/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_attempt_to_delete_okta_network_zone.toml,^zone\.delete$,(?i)zone,(?i)delete,,,,,,,,,,,,,,,1,0,45,1,
Attempt to Delete an Okta Policy,"Detects attempts to delete an Okta policy. An adversary may attempt to delete an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to delete an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_delete_okta_policy/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/defense_evasion_okta_attempt_to_delete_okta_policy.toml,^policy\.[^.]*\.(?:delete|remove)$,(?i)policy,(?i)(delete|remove),,,,,,,,,,,,,,,1,0,60,1,Policy deletions; match event.action like policy.delete
Attempt to Delete an Okta Policy Rule,Detects attempts to deactivate a rule within an Okta policy. An adversary may attempt to deactivate a rule within an Okta policy in order to remove or weaken an organization's security controls.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy_rule/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy_rule.toml,^policy\.rule\.delete$,(?i)policy\.rule,(?i)delete,,,,,,,,,,,,,,,1,0,55,1,
Attempt to Modify an Okta Application,"Detects attempts to modify an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/impact_okta_attempt_to_modify_okta_application/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/impact_okta_attempt_to_modify_okta_application.toml,^application\.lifecycle\.update$,(?i)application\.lifecycle,(?i)update,,,,,,,,,,,,,,,1,0,60,1,
Attempt to Modify an Okta Network Zone,"Detects attempts to modify an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_modify_okta_network_zone/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_okta_attempt_to_modify_okta_network_zone.toml,^(?:zone\.update|network_zone\.rule\.disabled|zone\.remove_blacklist)$,(?i)(zone|network\_zone\.rule),(?i)(update|disable|remove),,,,,,,,,,,,,,,1,0,60,1,
Attempt to Modify an Okta Policy,"Detects attempts to deactivate an Okta policy. An adversary may attempt to deactivate an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to deactivate an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_okta_attempt_to_deactivate_okta_policy.toml,^policy\.lifecycle\.update$,(?i)policy\.lifecycle,(?i)update,,,,,,,,,,,,,,,1,0,60,1,
Attempt to Modify an Okta Policy Rule,Detects attempts to modify a rule within an Okta policy. An adversary may attempt to modify an Okta policy rule in order to weaken an organization's security controls.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_okta_attempt_to_modify_okta_policy_rule/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/defense_evasion_okta_attempt_to_modify_okta_policy_rule.toml,^policy\.rule\.update$,(?i)policy\.rule,(?i)update,,,,,,,,,,,,,,,1,0,50,1,Policy rule updates; match event.action like policy.rule.update
Attempt to Reset MFA Factors for an Okta User Account,Attempt to Reset MFA Factors for an Okta User Account,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_attempt_to_reset_mfa_factors_for_okta_user_account/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/persistence_attempt_to_reset_mfa_factors_for_okta_user_account.toml,user\.mfa\.factor\.reset,(?i)user\.mfa\.factor,(?i)reset,,,,,,,,,,,,,,,1,0,55,1,MFA factor reset attempt; possible event.action user.mfa.factor.reset
Attempt to Revoke Okta API Token,Identifies attempts to revoke an Okta API token. An adversary may attempt to revoke or delete an Okta API token to disrupt an organization's business operations.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/impact_attempt_to_revoke_okta_api_token/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/impact_attempt_to_revoke_okta_api_token.toml,^system\.api_token\.revoke$,(?i)system\.api\_token,(?i)revoke,,,,,,,,,,,,,,,1,0,45,1,
Attempted Bypass of Okta MFA,Detects attempts to bypass Okta multi-factor authentication (MFA). An adversary may attempt to bypass the Okta MFA policies configured for an organization in order to obtain unauthorized access to an application.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_attempted_bypass_of_okta_mfa/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_attempted_bypass_of_okta_mfa.toml,^user\.mfa\.attempt_bypass$,,,,,,,,,,,,,,,,,1,0,45,1,
(?i)locked out|account locked,Identifies when an Okta user account is locked out 3 times within a 3 hour window. An adversary may attempt a brute force or password spraying attack to obtain unauthorized access to user accounts. The default Okta authentication policy ensures that a user account is locked out after 10 failed authentication attempts.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_attempts_to_brute_force_okta_user_account/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/credential_access_attempts_to_brute_force_okta_user_account.toml,^user\.account\.lock$,,,,(?i)locked out|account locked,,,,,,,,,,,,,0,0,40,1,Account lockouts >=3 in 3h; aggregate by actor.
First Occurrence of Okta User Session Started via Proxy,Identifies the first occurrence of an Okta user session started via a proxy.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_first_occurrence_user_session_started_via_proxy/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/initial_access_first_occurrence_user_session_started_via_proxy.toml,^app\.oauth2\.as\.token\.grant$,,,,,(?i)FAILURE,,,,,,,(?i)PublicClientApp,(?i)(Okta.*|Datadog),,,,0,1,40,1,
High Number of Okta Device Token Cookies Generated for Authentication,Detects when an Okta client address has a certain threshold of Okta user authentication events with multiple device token hashes generated for single user authentication. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_okta_multiple_device_token_hashes_for_single_user/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_okta_multiple_device_token_hashes_for_single_user.toml,^(?:user\.session\.start|user\.authentication\..+)$,,,(?i)\/api\/v1\/authn,,,(?i)(INVALID\_CREDENTIALS|INVALID|CREDENTIALS),,,,,,,,,,,0,0,40,1,
High Number of Okta User Password Reset or Unlock Attempts,Identifies a high number of Okta user password reset or account unlock attempts. An adversary may attempt to obtain unauthorized access to Okta user accounts using these methods and attempt to blend in with normal activity in their target's environment and evade detection.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_suspicious_okta_user_password_reset_or_unlock_attempts/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_suspicious_okta_user_password_reset_or_unlock_attempts.toml,^(?:system\.email\.account_unlock\.sent_message|system\.email\.password_reset\.sent_message|system\.sms\.send_account_unlock_message|system\.sms\.send_password_reset_message|system\.voice\.send_account_unlock_call|system\.voice\.send_password_reset_call|user\.account\.unlock_token)$,,,,,,,,,,,,,,,,,0,0,40,1,
MFA Deactivation with no Re-Activation for Okta User Account,Detects multi-factor authentication (MFA) deactivation with no subsequent re-activation for an Okta user account. An adversary may deactivate MFA for an Okta user account in order to weaken the authentication requirements for the account.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_mfa_deactivation_with_no_reactivation/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_okta_potentially_successful_okta_bombing_via_push_notifications.toml,^(?:user\.mfa\.factor\.deactivate|user\.mfa\.factor\.reset_all)$,,,,,(?i)SUCCESS,(?i)User reset SECURITY\_QUESTION factor,,,,,,,,,,,0,0,40,1,
Modification or Removal of an Okta Application Sign-On Policy,Detects attempts to modify or delete a sign on policy for an Okta application. An adversary may attempt to modify or delete the sign on policy for an Okta application in order to remove or weaken an organization's security controls.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_okta_attempt_to_modify_or_delete_application_sign_on_policy/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/persistence_okta_attempt_to_modify_or_delete_application_sign_on_policy.toml,policy\.sign_on\.(?:update|delete),(?i)policy\.sign_on,(?i)(update|delete),,,,,,,,,,,,,,,1,0,40,1,Sign-on policy updates or deletions; event.action policy.sign_on.(update|delete)
Multiple Device Token Hashes for Single Okta Session,"This rule detects when a specific Okta actor has multiple device token hashes for a single Okta session. This may indicate an authenticated session has been hijacked or is being used by multiple devices. Adversaries may hijack a session to gain unauthorized access to Okta admin console, applications, tenants, or other resources.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_multiple_device_token_hashes_for_single_okta_session/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/credential_access_multiple_device_token_hashes_for_single_okta_session.toml,.*,(?i)[^(policy\.evaluate\_sign\_on|user\.session\.start|user\.authentication\.sso)],,,,,,,,.*,,(?i)[^system\@okta\.com],,,(?i)[^unknown],,,0,0,40,1,Multiple dtHash for same session; group by uuid/session and count distinct dtHash.
Multiple Okta Sessions Detected for a Single User,Detects when a user has started multiple Okta sessions with the same user account and different session IDs. This may indicate that an attacker has stolen the user's session cookie and is using it to access the user's account from a different location.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/lateral_movement_multiple_sessions_for_single_user/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/lateral_movement_multiple_sessions_for_single_user.toml,^user\.session\.start$,,,,,,,,,,(?i)okta.*,,,(?i)okta.*,.*,,,0,0,40,1,
Multiple Okta User Auth Events with Same Device Token Hash Behind a Proxy,Detects when Okta user authentication events are reported for multiple users with the same device token hash behind a proxy.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_multiple_auth_events_from_single_device_behind_proxy/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_multiple_auth_events_from_single_device_behind_proxy.toml,^user\.authentication\..*$,(?i)user\.authentication,,,,,,,,.*,,,,,,,,0,1,40,1,
Multiple Okta User Authentication Events with Client Address,Detects when a certain threshold of Okta user authentication events are reported for multiple users from the same client address. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_multiple_device_token_hashes_for_single_okta_session/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_okta_authentication_for_multiple_users_from_single_source.toml,^(?:user\.session\.start|user\.authentication\..*)$,,,,,,(?i)(INVALID\_CREDENTIALS|INVALID|CREDENTIALS),,,,,,,,,,,0,0,40,1,
Multiple Okta User Authentication Events with Same Device Token Hash,Detects when a high number of Okta user authentication events are reported for multiple users in a short time frame. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_okta_authentication_for_multiple_users_with_the_same_device_token_hash/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/credential_access_okta_authentication_for_multiple_users_with_the_same_device_token_hash.toml,^(?:user\.session\.start|user\.authentication\..*)$,,,,,,(?i)(INVALID\_CREDENTIALS|INVALID|CREDENTIALS),,,(?i).*[^\-].*,,.*,,,,,,0,0,40,1,Group by debugData.dtHash across distinct users; threshold in short window.
(?i)New sign\-on behavior,Detects events where Okta behavior detection has identified a new authentication behavior.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_new_authentication_behavior_detection/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/initial_access_new_authentication_behavior_detection.toml,.*,,,,(?i)New sign\-on behavior,,,,,,,,,,,,,0,0,40,1,Behavior detection event; map to displayMessage contains 'New sign-on behavior' if present.
New Okta Identity Provider (IdP) Added by Admin,Detects the creation of a new Identity Provider (IdP) by a Super Administrator or Organization Administrator within Okta.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_new_idp_successfully_added_by_admin/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/persistence_new_idp_successfully_added_by_admin.toml,^system\.idp\.lifecycle\.create$,(?i)system\.idp\.lifecycle,(?i)create,,,,,,,,,,,,,,,1,0,40,1,
New Okta User Created,Detects new user account creation.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_user_created/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_user_created.yml,^user\.lifecycle\.create$,(?i)user\.lifecycle,(?i)create,,,,,,,,,,,,,,,1,0,40,1,eventtype user.lifecycle.create per Sigma rule
Okta Admin Functions Access Through Proxy,Detects access to Okta admin functions through proxy.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_admin_activity_from_proxy_query/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_admin_activity_from_proxy_query.yml,.*,,,(?i)\/admin,,,,,,,,,,,,,,0,1,50,1,Requires proxy flag and admin path in requestUri
Okta Admin Role Assigned to an User or Group,Detects when an the Administrator role is assigned to an user or group.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_admin_role_assigned_to_user_or_group/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^(?:group\.privilege\.grant|user\.account\.privilege\.grant)$,(?i)^(group\.privilege|user\.account\.privilege)$,(?i)^grant$,,,,,,,,,,,,,,,1,0,55,1,
Okta Admin Role Assignment Created,Detects when a new admin role assignment is created. Which could be a sign of privilege escalation or persistence.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_admin_role_assignment_created/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^iam\.resourceset\.bindings\.add$,(?i)^iam\.resourceset\.bindings$,(?i)^(add|create)$,,,,,,,,,,,,,,,1,0,60,1,
Okta API Token Created,Detects when a API Token is created.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_api_token_created/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^system\.api_token\.create$,(?i)^system\.api\_token,(?i)create,,,,,,,,,,,,,,,1,0,55,1,
Okta API Token Revoked,Detects when a API Token is revoked.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_api_token_revoked/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^system\.api_token\.revoke$,(?i)^system\.api\_token,(?i)revoke,,,,,,,,,,,,,,,1,0,55,1,
Okta Application Modified or Deleted,Detects when an application is modified or deleted.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_application_modified_or_deleted/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^application\.lifecycle\.(?:update|delete)$,(?i)application\.lifecycle,(?i)(update|delete),,,,,,,,,,,,,,,1,0,55,1,
Okta Application Sign-On Policy Modified or Deleted,Detects when an application Sign-on Policy is modified or deleted.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_application_sign_on_policy_modified_or_deleted/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^application\.policy\.sign_on\.(?:update|delete)$,(?i)application\.policy\.sign\_on,(?i)(update|delete),,,,,,,,,,,,,,,1,0,65,1,
Okta Brute Force or Password Spraying Attack,"Identifies a high number of failed Okta user authentication attempts from a single IP address, which could be indicative of a brute force or password spraying attack. An adversary may attempt a brute force or password spraying attack to obtain unauthorized access to user accounts.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_okta_brute_force_or_password_spraying/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/credential_access_okta_brute_force_or_password_spraying.toml,.*auth.*,,,,,(?i)FAIL|DENY,,,,,,,,,,,,0,0,60,1,Threshold of failed logins by src IP; implement aggregation by client.ip over window.
Okta FastPass Phishing Detection,Detects when Okta FastPass prevents a known phishing site.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_fastpass_phishing_detection/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^user\.authentication\.auth_via_mfa$,,,,,(?i)FAIL.*,(?i)FastPass declined phishing attempt,,,,,,,,,,,0,0,35,1,
Okta Identity Provider Created,Detects when a new identity provider is created for Okta.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_identity_provider_created/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_identity_provider_created.yml,^system\.idp\.lifecycle\.create$,(?i)system\.idp\.lifecycle,(?i)create,,,,,,,,,,,,,,,1,0,50,1,eventtype system.idp.lifecycle.create per Sigma
Okta MFA Reset or Deactivated,Detects when an attempt at deactivating  or resetting MFA.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_mfa_reset_or_deactivated/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^user\.mfa\.factor\.(?:deactivate|reset_all)$,(?i)user\.mfa\.factor,(?i)(deactivate|reset),,,,,,,,,,,,,,,1,0,45,1,
Okta Network Zone Deactivated or Deleted,Detects when an Network Zone is Deactivated or Deleted.,Sigma,https://detection.fyi/sigmahq/sigma/cloud/okta/okta_network_zone_deactivated_or_deleted/,https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/okta/okta_network_zone_deactivated_or_deleted.yml,^zone\.(?:deactivate|delete)$,(?i)zone,(?i)(deactivate|delete),,,,,,,,,,,,,,,1,0,40,1,Match eventtype zone.deactivate or zone.delete
Okta New Admin Console Behaviours,Detects when Okta identifies new activity in the Admin Console.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_new_behaviours_admin_console/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^policy\.evaluate_sign_on$,,,,,,,(?i)POSITIVE,(?i)POSITIVE,,,,,,,,,0,0,40,1,
Okta Policy Modified or Deleted,Detects when an Okta policy is modified or deleted.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_policy_modified_or_deleted/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^policy\.lifecycle\.(?:update|delete)$,(?i)policy\.lifecycle,(?i)(update|delete),,,,,,,,,,,,,,,1,0,55,1,
Okta Policy Rule Modified or Deleted,Detects when an Policy Rule is Modified or Deleted.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_policy_rule_modified_or_deleted/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/?query=okta.yml,^policy\.rule\.(?:update|delete)$,(?i)policy\.rule,(?i)(update|delete),,,,,,,,,,,,,,,1,0,60,1,
Okta Security Threat Detected,Detects when an security threat is detected in Okta.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_security_threat_detected/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_security_threat_detected.yml,^security\.threat\.detected$,,,,,,,,,,,,,,,,,0,0,40,1,Okta ThreatInsight events; map displayMessage or eventtype accordingly.
Okta Sign-In Events via Third-Party IdP,Detects sign-in events where authentication is carried out via a third-party Identity Provider (IdP).,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_sign_in_events_via_third_party_idp/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/initial_access_sign_in_events_via_third_party_idp.toml,^(?:user\.authentication\.auth_via_IDP|user\.authentication\.auth_via_inbound_SAML|user\.authentication\.auth_via_mfa|user\.authentication\.auth_via_social|user\.session\.start)$,,,(?i)\/oauth2\/.*\/v1\/authorize\/callback,,(?i)FAILURE,(?i)A SAML assert with the same ID has already been processed by Okta for a previous request|nable to match transformed username|nable to resolve IdP endpoint|nable to validate SAML Response|nable to validate incoming SAML Assertion,,,,,,,,,,,0,0,40,1,Sign-ins where authentication via external IdP; consider requestUri contains '/oauth2/*/v1/authorize'
(?i)User reported suspicious activity,Detects when an Okta end-user reports activity by their account as being potentially suspicious.,Sigma,https://detection.fyi/sigmahq/sigma/cloud/okta/okta_suspicious_activity_enduser_report/,https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/okta/okta_suspicious_activity_enduser_report.yml,^user\.account\.report_suspicious_activity_by_enduser$,,,,(?i)User reported suspicious activity,,,,,,,,,,,,,0,0,40,1,displayMessage contains 'User reported suspicious activity'
Okta ThreatInsight Threat Suspected Promotion,"Okta ThreatInsight is a feature that provides valuable debug data regarding authentication and authorization processes, which is logged in the system. Within this data, there is a specific field called threat_suspected, which represents Okta's internal evaluation of the authentication or authorization workflow. When this field is set to True, it suggests the presence of potential credential access techniques, such as password-spraying, brute-forcing, replay attacks, and other similar threats.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/okta_threatinsight_threat_suspected_promotion/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/okta_threatinsight_threat_suspected_promotion.toml,^security\.threat\.detected$,,,,,,,,,,,,,,,(?i)true,,0,0,40,1,
(?i)unauthorized access to app,Detects when unauthorized access to app occurs.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_unauthorized_access_to_app/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_unauthorized_access_to_app.yml,.*,,,,(?i)unauthorized access to app,,,,,,,,,,,,,0,0,35,1,displayMessage contains 'User attempted unauthorized access to app'
(?i)Max sign in attempts exceeded,Detects when an user account is locked out.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_user_account_locked_out/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_user_account_locked_out.yml,.*,,,,(?i)Max sign in attempts exceeded,,,,,,,,,,,,,0,0,30,1,displayMessage 'Account locked' or similar.
Okta User Session Impersonation,A user has initiated a session impersonation granting them access to the environment with the permissions of the user they are impersonating. This would likely indicate Okta administrative access and should only ever occur if requested and expected.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_user_impersonation_access/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_user_impersonation_access.toml,^user\.session\.impersonation\.initiate$,,,,,,,,,,,,,,,,,0,0,45,1,
Okta User Session Start Via An Anonymising Proxy Service,Detects when an Okta user session starts where the user is behind an anonymising proxy service.,Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_user_session_start_via_anonymised_proxy/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_user_session_start_via_anonymised_proxy.yml,^user\.session\.start$,(?i)user\.session,,,,,,,,,,,,,,,,0,1,40,1,eventtype user.session.start and isProxy true
Okta User Sessions Started from Different Geolocations,Detects when a specific Okta actor has multiple sessions started from different geolocations. Adversaries may attempt to launch an attack by using a list of known usernames and passwords to gain unauthorized access to user accounts from different locations.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_okta_user_sessions_started_from_different_geolocations/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/initial_access_okta_user_sessions_started_from_different_geolocations.toml,^(?:user\.session\.start|user\.authentication\..*)$,,,,,(?i)SUCCESS,,,,,(?i)unknown,,,,,,,0,0,40,1,
Possible Okta DoS Attack,Detects possible Denial of Service (DoS) attacks against an Okta organization. An adversary may attempt to disrupt an organization's business operations by performing a DoS attack against its Okta service.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/impact_possible_okta_dos_attack/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/impact_possible_okta_dos_attack.toml,^(?:application\.integration\.rate_limit_exceeded|system\.org\.rate_limit\.warning|system\.org\.rate_limit\.violation|core\.concurrency\.org\.limit\.violation)$,,,,,,,,,,,,,,,,,0,0,45,1,
Potential Okta MFA Bombing via Push Notifications,Detects when an attacker abuses the Multi-Factor authentication mechanism by repeatedly issuing login requests until the user eventually accepts the Okta push notification. An adversary may attempt to bypass the Okta MFA policies configured for an organization to obtain unauthorized access.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_okta_mfa_bombing_via_push_notifications/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/credential_access_okta_mfa_bombing_via_push_notifications.toml,^(?:user\.mfa\.okta_verify\.deny_push|user\.authentication\.auth_via_mfa|user\.authentication\.sso|user\.authentication\.verify|user\.session\.start)$,,,,,(?i)(DENY|REJECT|SUCCESS|ALLOW),(?i)(INVALID\_CREDENTIALS|INVALID|CREDENTIALS),,,,,,,,,,,0,0,45,1,Two denied Okta Verify pushes followed by success within 10m; aggregate by user.
Potential Okta Password in AlternateID Field,"Detects when a user has potentially entered their password into the username field, which will cause the password to be retained in log files.",Sigma,https://detection.fyi/sigmahq/sigma/identity/okta/okta_password_in_alternateid_field/,https://github.com/SigmaHQ/sigma/blob/master/rules/identity/okta/okta_password_in_alternateid_field.yml,.*,,,,,,,,,,,"(^0oa.*|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,10})",,,,,,0,0,40,1,legacyEventType core.user_auth.login_failed and actor.alternateId looks like non-email (per rule filters).
Potentially Successful Okta MFA Bombing via Push Notifications,Detects when an attacker abuses the Multi-Factor authentication mechanism by repeatedly issuing login requests until the user eventually accepts the Okta push notification. An adversary may attempt to bypass the Okta MFA policies configured for an organization to obtain unauthorized access.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/credential_access_okta_potentially_successful_okta_bombing_via_push_notifications/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/credential_access_okta_potentially_successful_okta_bombing_via_push_notifications.toml,^(?:user\.mfa\.okta_verify\.deny_push|user\.authentication\.auth_via_mfa|user\.authentication\.sso|user\.authentication\.verify|user\.session\.start)$,,,,,(?i)SUCCESS|ALLOW,(?i)(INVALID\_CREDENTIALS|INVALID|CREDENTIALS),,,,(?i).*,,,,,,,0,0,45,1,
Stolen Credentials Used to Login to Okta Account After MFA Reset,Stolen Credentials Used to Login to Okta Account After MFA Reset,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/persistence_stolen_credentials_used_to_login_to_okta_account_after_mfa_reset/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/persistence_stolen_credentials_used_to_login_to_okta_account_after_mfa_reset.toml,^(?:user\.mfa\.factor\.update|user\.session\.start|user\.authentication)$,,,,,(?i)SUCCESS|ALLOW,,,,,,,,,,,,0,0,40,1,Sequence logic after MFA reset; ensure preceding MFA reset detected followed by successful login.
(?i)single sign on|sso,"Detects successful single sign-on (SSO) events to Okta applications from an unrecognized or ""unknown"" client device, as identified by the user-agent string. This activity may be indicative of exploitation of a vulnerability in Okta's Classic Engine, which could allow an attacker to bypass application-specific sign-on policies, such as device or network restrictions. The vulnerability potentially enables unauthorized access to applications using only valid, stolen credentials, without requiring additional authentication factors.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_successful_application_sso_from_unknown_client_device/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/initial_access_successful_application_sso_from_unknown_client_device.toml,^user\.authentication\.sso$,,,,(?i)single sign on|sso,(?i)SUCCESS|ALLOW,,,,,,,,,,,(?i)unknown,0,0,40,1,User-agent indicates 'Unknown'; displayMessage may include 'User single sign on to app'
(?i)User Reported Suspicious Activity,"Detects when a user reports suspicious activity for their Okta account. These events should be investigated, as they can help security teams identify when an adversary is attempting to gain access to their network.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_suspicious_activity_reported_by_okta_user/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/initial_access_suspicious_activity_reported_by_okta_user.toml,^user\.account\.report_suspicious_activity_by_enduser$,,,,(?i)User Reported Suspicious Activity,,,,,,,,,,,,,0,0,40,1,Look for displayMessage like 'User Reported Suspicious Activity' if available.
Unauthorized Access to an Okta Application,Identifies unauthorized access attempts to Okta applications.,Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/initial_access_okta_user_attempted_unauthorized_access/,https://github.com/elastic/detection-rules/blob/main/rules/integrations/okta/initial_access_okta_user_attempted_unauthorized_access.toml,^app\.generic\.unauth_app_access_attempt$,,,,,,,,,,,,,,,,,0,0,40,1,KQL: event.dataset:okta.system AND event.action:app.generic.unauth_app_access_attempt
Unauthorized Scope for Public App OAuth2 Token Grant with Client Credentials,"Identifies a failed OAuth 2.0 token grant attempt for a public client app using client credentials. This event is generated when a public client app attempts to exchange a client credentials grant for an OAuth 2.0 access token, but the request is denied due to the lack of required scopes. This could indicate compromised client credentials in which an adversary is attempting to obtain an access token for unauthorized scopes. This is a New Terms rule where the okta.actor.display_name field value has not been seen in the last 14 days regarding this event.",Elastic,https://detection.fyi/elastic/detection-rules/integrations/okta/defense_evasion_first_occurence_public_app_client_credential_token_exchange/,https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta/defense_evasion_first_occurence_public_app_client_credential_token_exchange.toml,^app\.oauth2\.as\.token\.grant$,(?i)app\.oauth2\.as\.token,(?i)grant,,,,,,,,,,,,,,,0,0,40,1,