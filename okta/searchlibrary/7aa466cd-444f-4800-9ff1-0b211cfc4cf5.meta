{
	"Name": "AlertQuery - Okta - System - Alert Catalog - Elastic \u0026 Sigma Rulesets",
	"Description": "Detects Elastic \u0026 Sigma alerts that are configured within the okta_alerts_catalog lookup resource. \nOverall, the query enriches raw Okta System Log events, computes a risk score in $OKTA_RISK_SCORE_EXTENDED, applies user/IP tuning (allow/deny) in $OKTA_USER_TUNING and $OKTA_IP_TUNING, gates events against okta_alerts_catalog.csv in $OKTA_CATALOG_GATE, and emits a consistent alert title, priority, and context in $OKTA_ALERT_META.\n\nInputs and dependencies:\nEvent source: Okta System Log (tag=$OKTA_SYSTEM).\nDependencies \u0026 Lookups:\n  - $OKTA_ALERT_BASE\n    - tag=$OKTA_SYSTEM\n    - $OKTA_ALERT_EVX: Performs Enumerated Value Extraction (EVX).\n    - $OKTA_ENRICH_COMMON: Performs Enumerated Value enrichment, normalization, and high priority user tuning control.\n      - okta_eventTypes: Maps eventType to category, subcategory, is_mod for risk categorization and alert naming scheme.\n      - okta_privileged_actor: Provides a tuning control for High Privileged Actor Accounts and weigh their severity/priority differently compared to an end user.\n      - okta_protected_target: Provides a tuning control for High Privileged Target Accounts and weigh their severity/priority differently compared to an end user.\n  - $OKTA_CATALOG_RISK_SCORE: Performs risk calculations based on high priority user tuning control.\n    - Requires okta_privileged_actor and okta_protected_target to be run prior otherwise it will not work properly. \n  - $OKTA_IP_TUNING: Provides a tuning control for IP addresses causing noisy false positives and true negatives. \n    - okta_ip_allowlist.csv: Provides a tuning control to suppress alerts from known-good IPs (resolved from clientIp, else requestIp), per alert or globally, with expiry.\n    - okta_ip_denylist.csv: Provides a tuning control to force-include or escalate alerts from watchlisted IPs (resolved from clientIp, else requestIp), per alert or globally, with expiry.\n  - $OKTA_USER_TUNING: Provides a tuning control for end users causing noisy false positives and true negatives.\n    - okta_user_allowlist.csv: Provides a tuning control to suppress known-benign alerts for specific users (actor or target), either for a single alert name or globally, with expiry.\n    - okta_user_denylist.csv: Provides a tuning control to force-include or escalate alerts for specific users, optionally only when risk_score \u003e= min_risk, per alert or globally.\n  - $OKTA_CATALOG_GATE: Performs lookups against Elastic and Sigma rulesets to determine if any have triggered the parameters.\n    - okta_alerts_catalog.csv: This is a combination of Elastic and Sigma open source alerts cataloged for dashboards, macros, scheduled searches, alerts, and flows.\n  - $OKTA_ALERT_META: Normalized alert output (e.g. _alert_title, _alert_priority, and context)\n\nReference(s):\n  - Okta \n    - https://developer.okta.com/docs/reference/api/event-types/\n    - https://developer.okta.com/docs/api/openapi/okta-management/management/tag/SystemLog/\n  - Sigma:\n    - https://detection.fyi/sigmahq/sigma/identity/okta/?query=okta\n    - https://github.com/SigmaHQ/sigma/tree/master/rules/identity/okta\n  - Elastic:\n    - https://detection.fyi/elastic/detection-rules/integrations/okta/?query=okta\n    - https://github.com/elastic/detection-rules/tree/main/rules/integrations/okta",
	"GUID": "7aa466cd-444f-4800-9ff1-0b211cfc4cf5",
	"Labels": [
		"okta"
	],
	"Metadata": {
		"timeframe": null
	}
}